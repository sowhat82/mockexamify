#!/bin/bash
# Git post-merge hook - automatically installs/updates hooks after git pull

echo "üîÑ Post-merge: Checking if hooks need updating..."

# Check if install_hooks.sh exists and is newer than installed hooks
if [ -f "install_hooks.sh" ]; then
    NEEDS_INSTALL=false

    # Check if pre-push hook exists
    if [ ! -f ".git/hooks/pre-push" ]; then
        echo "üì¶ Pre-push hook not found. Installing hooks..."
        NEEDS_INSTALL=true
    else
        # Check if hooks/pre-push is newer than installed version
        if [ "hooks/pre-push" -nt ".git/hooks/pre-push" ]; then
            echo "üÜï Hook updates detected. Reinstalling..."
            NEEDS_INSTALL=true
        fi
    fi

    if [ "$NEEDS_INSTALL" = true ]; then
        # Make install script executable
        chmod +x install_hooks.sh

        # Run installation
        ./install_hooks.sh

        echo "‚úÖ Hooks installed/updated successfully!"
    else
        echo "‚úÖ Hooks are up to date."
    fi
else
    echo "‚ö†Ô∏è  install_hooks.sh not found. Skipping hook installation."
fi

echo ""
